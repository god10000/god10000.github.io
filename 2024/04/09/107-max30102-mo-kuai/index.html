<!DOCTYPE html>
<html lang="en" color-mode="light">

  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="author" content="南北的猫" />
  <!-- Open Graph Description 简短摘要-->
  
  <!-- 用于搜索引擎的文章摘要 -->
  
  
  
  <title>
    
      Max30102模块 
      
      
      |
    
     南北的猫
  </title>

  
    <link rel="apple-touch-icon" href="/images/favicon.png">
    <link rel="icon" href="/images/favicon.png">
  

  <!-- Raleway-Font -->
  <link href="https://fonts.googleapis.com/css?family=Raleway&display=swap" rel="stylesheet">

  <!-- hexo site css -->
  <link rel="stylesheet" href="/css/main.css" />
  <link rel="stylesheet" href="//at.alicdn.com/t/font_1886449_67xjft27j1l.css" />
  <!-- 代码块风格 -->
  

  <!-- jquery3.3.1 -->
  
    <script defer type="text/javascript" src="/plugins/jquery.min.js"></script>
  

  <!-- fancybox -->
  
    <link href="/plugins/jquery.fancybox.min.css" rel="stylesheet">
    <script defer type="text/javascript" src="/plugins/jquery.fancybox.min.js"></script>
  
  
<script src="/js/fancybox.js"></script>


  

  

  <script>
    var html = document.documentElement
    const colorMode = localStorage.getItem('color-mode')
    if (colorMode) {
      document.documentElement.setAttribute('color-mode', colorMode)
    }
  </script>
<meta name="generator" content="Hexo 6.1.0"><link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head>


  <body>
    <div id="app">
      <div class="header">
  <div class="avatar">
    <a href="/">
      <!-- 头像取消懒加载，添加no-lazy -->
      
        <img src="/images/avatar.png" alt="">
      
    </a>
    <div class="nickname"><a href="/">Northcat</a></div>
  </div>
  <div class="navbar">
    <ul>
      
        <li class="nav-item" data-path="/">
          <a href="/">Home</a>
        </li>
      
        <li class="nav-item" data-path="/archives/">
          <a href="/archives/">Archives</a>
        </li>
      
        <li class="nav-item" data-path="/tags/">
          <a href="/tags/">Tags</a>
        </li>
      
        <li class="nav-item" data-path="/friends/">
          <a href="/friends/">Friends</a>
        </li>
      
        <li class="nav-item" data-path="/about/">
          <a href="/about/">About</a>
        </li>
      
    </ul>
  </div>
</div>


<script src="/js/activeNav.js"></script>



      <div class="flex-container">
        <!-- 文章详情页，展示文章具体内容，url形式：https://yoursite/文章标题/ -->
<!-- 同时为「标签tag」，「朋友friend」，「分类categories」，「关于about」页面的承载页面，具体展示取决于page.type -->


  <!-- LaTex Display -->

  
    <script async type="text/javascript" src="/plugins/mathjax/tex-chtml.js"></script>
  
  <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      }
    }
  </script>





  <!-- clipboard -->

  
    <script async type="text/javascript" src="/plugins/clipboard.min.js"></script>
  
  
<script src="/js/codeCopy.js"></script>







  

  

  

  
  <!-- 文章内容页 url形式：https://yoursite/文章标题/ -->
  <div class="container post-details" id="post-details">
    <div class="post-content">
      <div class="post-title">Max30102模块</div>
      <div class="post-attach">
        <span class="post-pubtime">
          <i class="iconfont icon-updatetime mr-10" title="Update time"></i>
          2025-05-14 15:22:56
        </span>
        
      </div>
      <div class="markdown-body">
        <h2 id="寄存器"><a href="#寄存器" class="headerlink" title="寄存器"></a>寄存器</h2><pre class="line-numbers language-c" data-language="c"><code class="language-c">&#x2F;*MAX30102寄存器地址宏定义*&#x2F;
#define max30100_WR_address 0xAE
#define MAX30102_Device_address max30100_WR_address
#define I2C_WR	0		&#x2F;* 写控制bit *&#x2F;
#define I2C_RD	1		&#x2F;* 读控制bit *&#x2F;
#define REG_INTR_STATUS_1 		0x00
#define REG_INTR_STATUS_2 		0x01
#define REG_INTR_ENABLE_1 		0x02
#define REG_INTR_ENABLE_2 		0x03
#define REG_FIFO_WR_PTR 		0x04
#define REG_OVF_COUNTER 		0x05
#define REG_FIFO_RD_PTR 		0x06
#define REG_FIFO_DATA 			0x07
#define REG_FIFO_CONFIG 		0x08
#define REG_MODE_CONFIG 		0x09
#define REG_SPO2_CONFIG 		0x0A
#define REG_LED1_PA 			0x0C
#define REG_LED2_PA 			0x0D
#define REG_PILOT_PA 			0x10
#define REG_MULTI_LED_CTRL1 0x11
#define REG_MULTI_LED_CTRL2 0x12
#define REG_TEMP_INTR 			0x1F
#define REG_TEMP_FRAC 			0x20
#define REG_TEMP_CONFIG 		0x21
#define REG_PROX_INT_THRESH 0x30
#define REG_REV_ID 				0xFE
#define REG_PART_ID 			0xFF<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="读取寄存器的数据"><a href="#读取寄存器的数据" class="headerlink" title="读取寄存器的数据"></a>读取寄存器的数据</h2><p>读哪个寄存器</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">FIFO_DATA 			0x07<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>在使用MAX30102的FIFO时，通常不需要你直接操作FIFO读指针（FIFO_RD_PTR）。FIFO读指针的自动递增是MAX30102内部机制的一部分，旨在简化从FIFO中连续读取数据的过程。</p>
<p>当你从FIFO_DATA寄存器读取数据时，MAX30102内部的FIFO读指针会自动向前移动到下一个位置，准备下一次读取。这意味着每次读取操作后，FIFO_RD_PTR都会自动更新，指向FIFO中的下一个待读取数据，而无需手动干预。</p>
<p>如果你需要从FIFO的特定位置开始读取数据，或者需要重置FIFO到已知状态，你可以通过写入FIFO读指针、写指针和溢出计数器寄存器来实现。通常，在初始化MAX30102或准备新的数据采集会话之前，会将这些指针寄存器重置为零：</p>
<p><strong>怎么读</strong></p>
<blockquote>
<p>FIFO Data RegisterThe circular FIFO depth is 32 and can hold up to 32 samples of data. The sample size depends on the number of LED channels (a.k.a. channels) configured as active. As each channel signal is stored as a 3-byte data signal, the FIFO width can be 3 bytes or 6 bytes in size.The FIFO_DATA register in the I2C register map points to the next sample to be read from the FIFO. FIFO_RD_PTR points to this sample. Reading FIFO_DATA register, does not automatically increment the I2C register address. Burst reading this register, reads the same address over and over. Each sample is 3 bytes of data per channel (i.e., 3 bytes for RED, 3 bytes for IR, etc.).The FIFO registers (0x04–0x07) can all be written and read, but in practice only the FIFO_RD_PTR register should be written to in operation. The others are automatically incremented or filled with data by the MAX30102. When starting a new SpO2 or heart rate conversion, it is recommended to first clear the FIFO_WR_PTR, OVF_COUNTER, and FIFO_RD_PTR registers to all zeroes (0x00) to ensure the FIFO is empty and in a known state. When reading the MAX30102 registers in one burst-read I2C transaction, the register address pointer typically increments so that the next byte of data sent is from the next register, etc. The exception to this is the FIFO data register, register 0x07. When reading this register, the address pointer does not increment, but the FIFO_RD_PTR does. So the next byte of data sent represents the next byte of data available in the FIFO.Reading from the FIFONormally, reading registers from the I2C interface autoincrements the register address pointer, so that all the registers can be read in a burst read without an I2C start event. In the MAX30102, this holds true for all registers except for the FIFO_DATA register (register 0x07).Reading the FIFO_DATA register does not automatically increment the register address. Burst reading this register reads data from the same address over and over. Each sample comprises multiple bytes of data, so multiple bytes should be read from this register (in the same transaction) to get one full sample.The other exception is 0xFF. Reading more bytes after the 0xFF register does not advance the address pointer back to 0x00, and the data read is not meaningful.FIFO Data StructureThe data FIFO consists of a 32-sample memory bank that can store IR and Red ADC data. Since each sample consists of two channels of data, there are 6 bytes of data for each sample, and therefore 192 total bytes of data can be stored in the FIFO.The FIFO data is left-justified as shown in Table 1; in other words, the MSB bit is always in the bit 17 data position regardless of ADC resolution setting. See Table 2 for a visual presentation of the FIFO data structure  </p>
</blockquote>
<img src="/2024/04/09/107-max30102-mo-kuai/image-20240410214224496.png" class="" title="image-20240410214224496">

<p><strong>为什么读6次</strong></p>
<p>因为每个采样有两个数据通道,和六个字节</p>
<blockquote>
<p>The data FIFO consists of a 32-sample memory bank that can store IR and Red ADC data. Since each sample consists of <strong>two channels</strong> of data, there are <strong>6 bytes of data for each sample</strong></p>
</blockquote>
<h3 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h3><ol>
<li><strong>不是说地址不会自增吗,为什么可以重复读六次</strong></li>
</ol>
<blockquote>
<p>寄存器时地址不会自增，指的是单独对FIFO_DATA寄存器的读取操作不会导致I2C内部寄存器地址的自动递增，这意味着如果你反复发出读取指令，而不重新指定地址，你将会连续读到同一个寄存器的数据。</p>
</blockquote>
<blockquote>
<p>在你提供的代码示例中，通过一次I2C开始信号和设备地址（包含读位）的发送后，连续读取6个字节的数据实际上是在连续读取FIFO_DATA寄存器的当前内容6次。<strong>由于FIFO_RD_PTR（FIFO读指针）会在每次从FIFO_DATA寄存器读取数据后自动递增，所以每次读取操作实际上都会获取到FIFO中的下一个数据样本，即使寄存器地址没有改变</strong>。</p>
</blockquote>
<ol start="2">
<li><p><strong>不太理解FIFO_RD_PTR与FIFO_DATA的关系</strong></p>
<p>FIFO读指针的自动递增是MAX30102内部机制的一部分，旨在简化从FIFO中连续读取数据的过程。</p>
<p>当你从FIFO_DATA寄存器读取数据时，MAX30102内部的FIFO读指针会自动向前移动到下一个位置，准备下一次读取。这意味着每次读取操作后，FIFO_RD_PTR都会自动更新，指向FIFO中的下一个待读取数据，而无需手动干预。</p>
   <pre class="line-numbers language-c" data-language="c"><code class="language-c">void MAX30102_IIC_ReadReg(uint8_t slave_ID,uint8_t RegAddress)  &#x2F;&#x2F;读取6个字节
&#123;
    fifo_red&#x3D;0;
    fifo_ir&#x3D;0;
	uint16_t Data1,Data2,Data3,Data4,Data5,Data6;
	
	IIC_Start();						&#x2F;&#x2F;I2C起始
	IIC_SendByte(slave_ID);	&#x2F;&#x2F;发送从机地址，读写位为0，表示即将写入
	IIC_ReceiveAck();					&#x2F;&#x2F;接收应答
	IIC_SendByte(RegAddress);			&#x2F;&#x2F;发送寄存器地址
	IIC_ReceiveAck();					&#x2F;&#x2F;接收应答
	
	IIC_Start();						&#x2F;&#x2F;I2C重复起始
	IIC_SendByte(slave_ID | 0x01);	&#x2F;&#x2F;发送从机地址，读写位为1，表示即将读取
	IIC_ReceiveAck();					&#x2F;&#x2F;接收应答
	Data1 &#x3D; IIC_ReceiveByte();			&#x2F;&#x2F;接收指定寄存器的数据
	IIC_SendAck(0);					&#x2F;&#x2F;发送应答，给从机非应答，终止从机的数据输出
	Data2 &#x3D; IIC_ReceiveByte();
	IIC_SendAck(0);	
	Data3 &#x3D; IIC_ReceiveByte();
	IIC_SendAck(0);
	Data4 &#x3D; IIC_ReceiveByte();			&#x2F;&#x2F;接收指定寄存器的数据
	IIC_SendAck(0);					&#x2F;&#x2F;发送应答，给从机非应答，终止从机的数据输出
	Data5 &#x3D; IIC_ReceiveByte();
	IIC_SendAck(0);	
	Data6 &#x3D; IIC_ReceiveByte();
	IIC_SendAck(1);
	IIC_Stop();	
	&#x2F;&#x2F;I2C终止
    &#x2F;&#x2F;将读取的6个字节数据通过位移操作重组成两个18位的数据，分别代表红光和红外光通
	Data1 &lt;&lt;&#x3D; 14;    
    fifo_red+&#x3D;Data1;
	Data2 &lt;&lt;&#x3D; 6;
    fifo_red+&#x3D;Data2;
	Data3 &gt;&gt;&#x3D; 2;
    fifo_red+&#x3D;Data3;
	
	Data4 &lt;&lt;&#x3D; 14;
    fifo_ir+&#x3D;Data4;
	Data5 &lt;&lt;&#x3D; 6;
    fifo_ir+&#x3D;Data5;
	Data6 &gt;&gt;&#x3D; 2;
    fifo_ir+&#x3D;Data6;
	
	if(fifo_ir&lt;&#x3D;10000)
	&#123;
		fifo_ir&#x3D;0;
	&#125;
	if(fifo_red&lt;&#x3D;10000)
	&#123;
		fifo_red&#x3D;0;
	&#125;
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>
<p>MSB（Most Significant Bit）指的是二进制数字中最高位的位，即权值最大的位。在一个二进制数中，MSB位于最左边。对于一个给定的非负数，MSB对数值的影响最大，因为它代表了最大的权值。</p>
<ol start="3">
<li>**这个移位究竟是怎么个移位</li>
</ol>
<ul>
<li><strong>BYTE 1</strong> 包含了最高有效位，也就是<code>FIFO_DATA[17]</code>和<code>FIFO_DATA[16]</code>。</li>
<li><strong>BYTE 2</strong> 包含了接下来的位，从<code>FIFO_DATA[15]</code>到<code>FIFO_DATA[8]</code>。</li>
<li><strong>BYTE 3</strong> 包含了<code>FIFO_DATA[7]</code>到<code>FIFO_DATA[0]</code>，</li>
</ul>
<blockquote>
<p>0000 00aa</p>
<p>aa00  0000 0000 0000</p>
<p>bbccddee</p>
<p>bb ccdd ee00 0000</p>
<p>kkll mmnn</p>
<p>00kk llmm nn</p>
</blockquote>
<blockquote>
<p>aa00  0000 0000 0000 00</p>
<p>​    bb ccdd ee00 0000 00 </p>
<p>​                  00kk llmm nn</p>
</blockquote>
<h2 id="通过公式计算"><a href="#通过公式计算" class="headerlink" title="通过公式计算"></a>通过公式计算</h2><h2 id="心率原理"><a href="#心率原理" class="headerlink" title="心率原理"></a>心率原理</h2><img src="/2024/04/09/107-max30102-mo-kuai/image-20240412082525496.png" class="" title="image-20240412082525496">

<img src="/2024/04/09/107-max30102-mo-kuai/image-20240412082501374.png" class="" title="image-20240412082501374">

<p>顺势心率可以通过测量连续收缩峰值之间的时间来计算</p>
<p>注意: 只使用一个LED就可以测量心率,因为只需要交流信号分量</p>
<h2 id="血氧原理"><a href="#血氧原理" class="headerlink" title="血氧原理"></a>血氧原理</h2><p>1.4 血氧计算(SpO2)</p>
<p>血氧浓度，是指血中氧饱和血红蛋白相对于总<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E8%A1%80%E7%BA%A2%E8%9B%8B%E7%99%BD">血红蛋白</a>（不饱和+饱和）的比例</p>
<p>血压计算公式也比较简单，这里MAX30102是一路红光，一路红外。只分别算出红光的交流除以红光的直流即: ACred&#x2F;DCred，和红外的交流除以红外的直流分量即：ACired&#x2F;DCired。然后两者再相除得到R。</p>
<h3 id="咋算"><a href="#咋算" class="headerlink" title="咋算???"></a>咋算???</h3><img src="/2024/04/09/107-max30102-mo-kuai/20201107134420733.png" class="" title="img">

<p>得到 R 然后查表即可得到血氧值，也可以通过下面美信拟合的公式计算：</p>
<p><code>SpO2 = -45.060*R*R + 30.354 *R + 94.845</code></p>
<p>4、心率识别：<br>delta &#x3D; 图3两个尖峰时间；<br>心率 &#x3D; 1 &#x2F; dalta.</p>
<p>5、血氧计算<br>R&#x3D;((ir_max+ir_min)(red_max-red_min))&#x2F;((red_max+red_min)(ir_max-ir_min));<br>SpO2&#x3D; ((-45.060)RR + 30.354*R + 94.845).</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><ol>
<li><p>看不懂手册, 中文的也看不懂</p>
</li>
<li><p>目前问题是,读出了fifo的数据, 不知道对不对, 不知道咋那么用</p>
</li>
<li><p>打算提取例程库直接拿数据试试</p>
</li>
<li><p>读取的寄存器的值是什么</p>
<p><code>红光和红外光的反射值</code></p>
<blockquote>
<p>MAX30102脉搏血氧仪和心率传感器包含两个LED，分别发射红光(RED)和红外光(IR)，光线照射进人体组织后一部分被吸收，另一部分反射光被集成的光电传感器捕获、转变为电信号。两种光的电信号都会呈现出具有直流(DC)成分的交流(AC)信号，AC成分的频率就是脉搏频率，使用任何一个电信号就能获得心跳频率。</p>
<p>血氧浓度(SpO2)的计算需要同时使用两个电信号，估算SpO2</p>
<img src="/2024/04/09/107-max30102-mo-kuai/image-20240418112027421.png" class="" title="image-20240418112027421"></blockquote>
</li>
<li><p>如何将其转换为心率和血氧(也就是算法)</p>
</li>
<li><p>不要纠结自己重新做一遍,这样也是有好处的,可以发现自己的问题</p>
<p>但是最宝贵的是时间,我需要用尽量少的时间尽可能的完成较多的任务</p>
<p>,明白其原理,移植就可以了</p>
<p>加油</p>
</li>
</ol>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_62425199/article/details/136096478?spm=1001.2101.3001.6650.2&utm_medium=distribute.pc_relevant.none-task-blog-2~default~YuanLiJiHua~Position-2-136096478-blog-128573054.235%5Ev43%5Epc_blog_bottom_relevance_base8&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~YuanLiJiHua~Position-2-136096478-blog-128573054.235%5Ev43%5Epc_blog_bottom_relevance_base8&utm_relevant_index=3">MAX30102寄存器参考</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/u012183892/article/details/109545972?ops_request_misc=%7B%22request_id%22:%22171283555616800227478257%22,%22scm%22:%2220140713.130102334.pc_blog.%22%7D&request_id=171283555616800227478257&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_ecpm_v1~hot_rank-1-109545972-null-null.nonecase&utm_term=max30102%E5%BF%83%E7%8E%87%E7%AE%97%E6%B3%95&spm=1018.2226.3001.4450">算法参考</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/tutututuo/article/details/115050516">MAX30102学习笔记（下）_max30102与0.96寸oled连接-CSDN博客</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/u012183892/article/details/109545972?ops_request_misc=%7B%22request_id%22:%22171283555616800227478257%22,%22scm%22:%2220140713.130102334.pc_blog.%22%7D&request_id=171283555616800227478257&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_ecpm_v1~hot_rank-1-109545972-null-null.nonecase&utm_term=max30102%E5%BF%83%E7%8E%87%E7%AE%97%E6%B3%95&spm=1018.2226.3001.4450">MAX30102 血氧调试笔记-CSDN博客</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_37385726/article/details/89041710">光电容积脉搏波描记法PPG-CSDN博客</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_62425199/article/details/136096478?ops_request_misc=%7B%22request_id%22:%22171341003516800225526011%22,%22scm%22:%2220140713.130102334.pc_blog.%22%7D&request_id=171341003516800225526011&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_ecpm_v1~times_rank-1-136096478-null-null.nonecase&utm_term=max30102%E4%BC%A0%E6%84%9F%E5%99%A8%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86&spm=1018.2226.3001.4450">MAX30102脉搏血氧仪和心率传感器（含寄存器介绍）_max30102心率算法详解-CSDN博客</a></p>

      </div>
      
        <div class="prev-or-next">
          <div class="post-foot-next">
            
              <a href="/2024/04/08/106-chao-sheng-bo-mo-kuai/" target="_self">
                <i class="iconfont icon-chevronleft"></i>
                <span>Prev</span>
              </a>
            
          </div>
          <div class="post-attach">
            <span class="post-pubtime">
              <i class="iconfont icon-updatetime mr-10" title="Update time"></i>
              2025-05-14 15:22:56
            </span>
            
          </div>
          <div class="post-foot-prev">
            
              <a href="/2024/04/11/108-ji-yu-python-de-shang-wei-ji-ping-tai/" target="_self">
                <span>Next</span>
                <i class="iconfont icon-chevronright"></i>
              </a>
            
          </div>
        </div>
      
    </div>
    
  <div id="btn-catalog" class="btn-catalog">
    <i class="iconfont icon-catalog"></i>
  </div>
  <div class="post-catalog hidden" id="catalog">
    <div class="title">Contents</div>
    <div class="catalog-content">
      
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%84%E5%AD%98%E5%99%A8"><span class="toc-text">寄存器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%BB%E5%8F%96%E5%AF%84%E5%AD%98%E5%99%A8%E7%9A%84%E6%95%B0%E6%8D%AE"><span class="toc-text">读取寄存器的数据</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%97%AE%E9%A2%98"><span class="toc-text">问题</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%80%9A%E8%BF%87%E5%85%AC%E5%BC%8F%E8%AE%A1%E7%AE%97"><span class="toc-text">通过公式计算</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BF%83%E7%8E%87%E5%8E%9F%E7%90%86"><span class="toc-text">心率原理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A1%80%E6%B0%A7%E5%8E%9F%E7%90%86"><span class="toc-text">血氧原理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%92%8B%E7%AE%97"><span class="toc-text">咋算???</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-text">总结</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83"><span class="toc-text">参考</span></a></li></ol>
      
    </div>
  </div>

  
<script src="/js/catalog.js"></script>




    
      <div class="comments-container">
        







      </div>
    
  </div>


        
<div class="footer">
  <div class="social">
    <ul>
      
        <li>
          
              <a title="github" target="_blank" rel="noopener" href="https://github.com/zchengsite/hexo-theme-oranges">
                <i class="iconfont icon-github"></i>
              </a>
              
        </li>
        
    </ul>
  </div>
  
    
    <div class="footer-more">
      
        <a target="_blank" rel="noopener" href="https://github.com/zchengsite/hexo-theme-oranges">Copyright © 2025 Oranges</a>
        
    </div>
  
    
    <div class="footer-more">
      
        <a target="_blank" rel="noopener" href="https://github.com/zchengsite/hexo-theme-oranges">Theme by Oranges | Powered by Hexo</a>
        
    </div>
  
  
</div>

      </div>

      <div class="tools-bar">
        <div class="back-to-top tools-bar-item hidden">
  <a href="javascript: void(0)">
    <i class="iconfont icon-chevronup"></i>
  </a>
</div>


<script src="/js/backtotop.js"></script>



        
  <div class="search-icon tools-bar-item" id="search-icon">
    <a href="javascript: void(0)">
      <i class="iconfont icon-search"></i>
    </a>
  </div>

  <div class="search-overlay hidden">
    <div class="search-content" tabindex="0">
      <div class="search-title">
        <span class="search-icon-input">
          <a href="javascript: void(0)">
            <i class="iconfont icon-search"></i>
          </a>
        </span>
        
          <input type="text" class="search-input" id="search-input" placeholder="Search...">
        
        <span class="search-close-icon" id="search-close-icon">
          <a href="javascript: void(0)">
            <i class="iconfont icon-close"></i>
          </a>
        </span>
      </div>
      <div class="search-result" id="search-result"></div>
    </div>
  </div>

  <script type="text/javascript">
    var inputArea = document.querySelector("#search-input")
    var searchOverlayArea = document.querySelector(".search-overlay")

    inputArea.onclick = function() {
      getSearchFile()
      this.onclick = null
    }

    inputArea.onkeydown = function() {
      if(event.keyCode == 13)
        return false
    }

    function openOrHideSearchContent() {
      let isHidden = searchOverlayArea.classList.contains('hidden')
      if (isHidden) {
        searchOverlayArea.classList.remove('hidden')
        document.body.classList.add('hidden')
        // inputArea.focus()
      } else {
        searchOverlayArea.classList.add('hidden')
        document.body.classList.remove('hidden')
      }
    }

    function blurSearchContent(e) {
      if (e.target === searchOverlayArea) {
        openOrHideSearchContent()
      }
    }

    document.querySelector("#search-icon").addEventListener("click", openOrHideSearchContent, false)
    document.querySelector("#search-close-icon").addEventListener("click", openOrHideSearchContent, false)
    searchOverlayArea.addEventListener("click", blurSearchContent, false)

    var searchFunc = function (path, search_id, content_id) {
      'use strict';
      var $input = document.getElementById(search_id);
      var $resultContent = document.getElementById(content_id);
      $resultContent.innerHTML = "<ul><span class='local-search-empty'>First search, index file loading, please wait...<span></ul>";
      $.ajax({
        // 0x01. load xml file
        url: path,
        dataType: "xml",
        success: function (xmlResponse) {
          // 0x02. parse xml file
          var datas = $("entry", xmlResponse).map(function () {
            return {
              title: $("title", this).text(),
              content: $("content", this).text(),
              url: $("url", this).text()
            };
          }).get();
          $resultContent.innerHTML = "";

          $input.addEventListener('input', function () {
            // 0x03. parse query to keywords list
            var str = '<ul class=\"search-result-list\">';
            var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
            $resultContent.innerHTML = "";
            if (this.value.trim().length <= 0) {
              return;
            }
            // 0x04. perform local searching
            datas.forEach(function (data) {
              var isMatch = true;
              var content_index = [];
              if (!data.title || data.title.trim() === '') {
                data.title = "Untitled";
              }
              var orig_data_title = data.title.trim();
              var data_title = orig_data_title.toLowerCase();
              var orig_data_content = data.content.trim().replace(/<[^>]+>/g, "");
              var data_content = orig_data_content.toLowerCase();
              var data_url = data.url;
              var index_title = -1;
              var index_content = -1;
              var first_occur = -1;
              // only match artiles with not empty contents
              if (data_content !== '') {
                keywords.forEach(function (keyword, i) {
                  index_title = data_title.indexOf(keyword);
                  index_content = data_content.indexOf(keyword);

                  if (index_title < 0 && index_content < 0) {
                    isMatch = false;
                  } else {
                    if (index_content < 0) {
                      index_content = 0;
                    }
                    if (i == 0) {
                      first_occur = index_content;
                    }
                    // content_index.push({index_content:index_content, keyword_len:keyword_len});
                  }
                });
              } else {
                isMatch = false;
              }
              // 0x05. show search results
              if (isMatch) {
                str += "<li><a href='" + data_url + "' class='search-result-title'>" + orig_data_title + "</a>";
                var content = orig_data_content;
                if (first_occur >= 0) {
                  // cut out 100 characters
                  var start = first_occur - 20;
                  var end = first_occur + 80;

                  if (start < 0) {
                    start = 0;
                  }

                  if (start == 0) {
                    end = 100;
                  }

                  if (end > content.length) {
                    end = content.length;
                  }

                  var match_content = content.substr(start, end);

                  // highlight all keywords
                  keywords.forEach(function (keyword) {
                    var regS = new RegExp(keyword, "gi");
                    match_content = match_content.replace(regS, "<span class=\"search-keyword\">" + keyword + "</span>");
                  });

                  str += "<p class=\"search-result-abstract\">" + match_content + "...</p>"
                }
                str += "</li>";
              }
            });
            str += "</ul>";
            if (str.indexOf('<li>') === -1) {
              return $resultContent.innerHTML = "<ul><span class='local-search-empty'>No result<span></ul>";
            }
            $resultContent.innerHTML = str;
          });
        },
        error: function(xhr, status, error) {
          $resultContent.innerHTML = ""
          if (xhr.status === 404) {
            $resultContent.innerHTML = "<ul><span class='local-search-empty'>The search.xml file was not found, please refer to：<a href='https://github.com/zchengsite/hexo-theme-oranges#configuration' target='_black'>configuration</a><span></ul>";
          } else {
            $resultContent.innerHTML = "<ul><span class='local-search-empty'>The request failed, Try to refresh the page or try again later.<span></ul>";
          }
        }
      });
      $(document).on('click', '#search-close-icon', function() {
        $('#search-input').val('');
        $('#search-result').html('');
      });
    }

    var getSearchFile = function() {
        var path = "/search.xml";
        searchFunc(path, 'search-input', 'search-result');
    }
  </script>




        
  <div class="tools-bar-item theme-icon" id="switch-color-scheme">
    <a href="javascript: void(0)">
      <i id="theme-icon" class="iconfont icon-moon"></i>
    </a>
  </div>

  
<script src="/js/colorscheme.js"></script>





        
  
    <div class="share-icon tools-bar-item">
      <a href="javascript: void(0)" id="share-icon">
        <i class="iconfont iconshare"></i>
      </a>
      <div class="share-content hidden">
        
          <a class="share-item" href="https://twitter.com/intent/tweet?text=' + Max30102%E6%A8%A1%E5%9D%97 + '&url=' + http%3A%2F%2Fblog.isgeek.top%2F2024%2F04%2F09%2F107-max30102-mo-kuai%2F + '" target="_blank" title="Twitter">
            <i class="iconfont icon-twitter"></i>
          </a>
        
        
          <a class="share-item" href="https://www.facebook.com/sharer.php?u=http://blog.isgeek.top/2024/04/09/107-max30102-mo-kuai/" target="_blank" title="Facebook">
            <i class="iconfont icon-facebooksquare"></i>
          </a>
        
      </div>
    </div>
  
  
<script src="/js/shares.js"></script>



      </div>
    </div>
  </body>
</html>
